<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Cancellation View</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">

  <div class=" mainCard" [ngClass]="{'blurred': !hidePopup}">

    <div style="height: 370px;overflow: auto;padding: 20px;">
        <!-- Details -->
        <div class="row">
                <div class="col-6">
                    <div style="height: 100%;">
                        <div class="row">
                                <div class="col-12" style="border-bottom:1px solid black;">
                                    <label class="HeaderText">Customer</label>
                                </div> 
                        </div>
    
                        <div class="row">
                            <div class="col-12 mt-2"> 
                                <b style="font-size: 17px !important;letter-spacing: 2px;">{{objCaseDetail?.CUSTOMER.FirstName}} {{objCaseDetail?.CUSTOMER.LastName}}</b><br>
                                <label style="letter-spacing: 2px;">{{objCaseDetail?.CUSTOMER.MobileNo}}</label><br>
                                <label style="letter-spacing: 2px;">{{objCaseDetail?.CUSTOMER.Address1}}</label><br>
                                <label style="letter-spacing: 2px;">{{objCaseDetail?.CUSTOMER.Address2}}</label> 
                            </div>
                        </div>
    
                    </div>
                </div>
                <div class="col-6">
                    <div card style="height: 100%;">
                        <div class="row">
                                <div class="col-12" style="border-bottom:1px solid black;">
                                    <label class="HeaderText">Location</label>
                                </div> 
                        </div>
    
                        <div class="row">
                            <div class="col-12 mt-2"> 
                                <b style="font-size: 17px !important;letter-spacing: 2px;">{{objCaseDetail?.LOCATION.LocationName}} </b><br>
                                <label style="letter-spacing: 2px;">{{objCaseDetail?.LOCATION.MobileNo}}</label><br>
                                <label style="letter-spacing: 2px;">{{objCaseDetail?.LOCATION.Address1}}</label><br>
                                <label style="letter-spacing: 2px;">{{objCaseDetail?.LOCATION.Address2}}</label> <br>
                                <label style="letter-spacing: 2px;">{{objCaseDetail?.LOCATION.StateName}} ,  {{objCaseDetail?.LOCATION.ZipCode}} </label> 
    
                            </div>
                        </div>
    
                    </div>
                </div>
    
        </div>
    
        <!-- inspection -->
        <div class="mt-2">
            <div class="row">
                    <div class="col-12" style="border-bottom:1px solid black;">
                        <label class="HeaderText">Inspection</label>
                    </div>
                    <div style="padding: 5px;">
                        <div>
                            <div class="col-12">
                                <div class="row">
                                    <div class="col-3">
                                        <b>Diagnosis Code</b> <br>
                                        <label> {{objCaseDetail?.DIAG?.DiagnosisCode}}</label>
    
                                    </div>
                                    <div class="col-3">
                                        <b>Diagnosis Date</b> <br>
                                        <label> {{objCaseDetail?.DIAG?.DiagnosisDate}}</label>
    
                                    </div>
                                    <div class="col-3"> 
                                        <b>Repair Type</b> <br>
                                        <label> {{objCaseDetail?.DIAG?.RepairTypeDesc}}</label>
    
                                    </div>
                                    <div class="col-3">
                                        <b>Reason</b> <br>
                                        <label> {{objCaseDetail?.DIAG?.Reason}}</label>
                                    </div>
                                </div>
    
                                <div class="row mt-3">
                                    <div class="col-3">
                                        <b>Remark</b> <br>
                                        <label> {{objCaseDetail?.DIAG?.Remark}}</label>
    
                                    </div>
                                    <div class="col-3">
                                        <b>Payment Term</b> <br>
                                        <label> {{objCaseDetail?.DIAG?.PaymentTerms}}</label>
    
                                    </div> 
                                    <div class="col-3">
                                        <b>Trouble Shooting By Engineer</b> <br>
                                        <label> {{objCaseDetail?.DIAG?.TroubleShootingByEngineer}}</label>
                                    </div>                                
                                </div>
                            </div>
                        </div>
                    </div>
            </div>
        </div>
     
        <!-- Quote -->
        <div class="mt-2"  *ngIf="isShowQuote">
            <div class="row">
                <div class="col-12" style="border-bottom:1px solid black;">
                    <label class="HeaderText">Quote</label>
                </div>
                <div style="padding: 5px;">
                    <div> 
                        <table>
                            <thead>
                                <th>Part Code</th>
                                <th>Part Description</th>
                                <th>Item Type</th>
                                <th>Unit Price</th>
                                <th>Tax Amout</th>
                            </thead>
                        <tbody>
                            <tr  *ngFor="let item of quoteList" >
                                <td> {{item?.ItemCode}}</td>
                                <td>  {{item?.ItemDescription}}</td>
                                <td> {{item?.ItemType}}</td>
                                <td>  {{item?.UnitPrice}}</td>
                                <td> {{item?.TaxAmount}}</td>
                            </tr>
                        </tbody>
                        </table> 
                    </div>
                </div>
            </div>
        </div>
     
        <!-- Repair Parts -->
        <div class="mt-3"  *ngIf="isShowRepairParts" >
            <div class="row">
                <div class="col-12" style="border-bottom:1px solid black;">
                    <label class="HeaderText">Repair Parts</label>
                </div>
                <div style="padding: 5px;">
                    <div> 
                        <table>
                            <thead>
                                <th>Part Code</th>
                                <th>Part Description</th>
                                <th>Quantity</th>
                                <th>Unit Price</th>
                                <th>Component Desc </th>
                                <th>Issue Desc</th>
                                <th>Coverage Description</th>
                                <th>Consignment Stock Use</th>
                            </thead>
                        <tbody>
                            <tr  *ngFor="let item of reapairList" >
                                <td> {{item?.PartCode}}</td>
                                <td>  {{item?.PartDescription}}</td>
                                <td> {{item?.Quantity}}</td>
                                <td>  {{item?.UnitPrice}}</td>
                                <td> {{item?.ComponentDescription}}</td>
                                <td> {{item?.IssueDescription}}</td>
                                <td> {{item?.CoverageOptionDescription}}</td>
                                <td> {{item?.ConsignmentStockUsed}}</td>
    
    
                                
    
                            </tr>
                        </tbody>
                        </table> 
                    </div>
                </div>
            </div>
        </div>
    
        <!-- Notes -->
        <div class="mt-3" *ngIf="isShowNotes">
            <div class="row">
                <div class="col-12" style="border-bottom:1px solid black;">
                    <label class="HeaderText">Notes</label>
                </div>
                <div style="padding: 5px;">
                    <div> 
                        <div *ngFor="let item of notesList">
                            <b>{{item.NotesTypeDesc}}</b> <br>
                            <label>{{item.Notes}}</label>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>    
     
        <!-- Invoice -->
        <div class="mt-3"  *ngIf="isShowInvoice">
            <div class="row">
                <div class="col-12" style="border-bottom:1px solid black;">
                    <label class="HeaderText">Invoice</label>
                </div>
                <div style="padding: 5px;">
                    <div> 
    
                        <table>
                            <thead>
                                <th>Part Code</th>
                                <th>Part Description</th>
                                <th>Item Type</th>
                                <th>Unit Price</th>
                                <th>Tax Amout</th>
                            </thead>
                        <tbody>
                            <tr  *ngFor="let item of  invoiceList">
                                <td> {{item?.ItemCode}}</td>
                                <td>  {{item?.ItemDescription}}</td>
                                <td> {{item?.ItemType}}</td>
                                <td>  {{item?.UnitPrice}}</td>
                                <td> {{item?.TaxAmount}}</td>
                            </tr>
                        </tbody>
                        </table>                
                    </div>
                </div>
            </div>
        </div>  
        
        <!-- Ready For Pickup -->
        <div class="mt-3" *ngIf="isShowRFP" >
            <div class="row">
                <div class="col-12" style="border-bottom:1px solid black;">
                    <label class="HeaderText">Ready For PickUp</label>
                </div>
                <div style="padding: 5px;">
                    <div> 
                        <div class="row" *ngFor="let item of  RFPList">
                            <div class="col-3">
                                <b>RFP Code</b><br>
                                <label>{{item.RFPCode}}</label>
                            </div>
                            
                            <div class="col-3">
                                <b>RFP Date</b><br>
                                <label>{{item.RFPDate}}</label>
                            </div>
    
                            <div class="col-3">
                                <b>RFP Description</b><br>
                                <label>{{item.RFPDesc}}</label>
                            </div>
    
                            <div class="col-3">
                                <b>Remark</b><br>
                                <label>{{item.Remark}}</label>
                            </div>
    
                        </div>
                        
                    </div>
                </div>
            </div>
        </div> 
         
    </div>
    
    
    <div style="padding: 10px;"  *ngIf="isApprove">
        <!-- Cancel  -->
        <div  style="background-color: rgb(226, 226, 226);">
            <div class="row">
                <div class="col-12" style="border-bottom:1px solid black;">
                <b  class="HeaderText"> Request for Cancel   </b> 
                </div>
            </div>
    
    
            <div class="row mt-3">
                <div class="col-6">
                    <b>Cancellation Reason</b><br>
                    <label>{{objCaseDetail?.JOBCancellationRequest?.CancellationReason}}</label>
                </div>
    
                <div class="col-6">
                    <b>Cancellation Notes</b><br>
                    <label>{{objCaseDetail?.JOBCancellationRequest?.CancellationNotes}}</label>
                </div> 
            </div>
    
    
            <div class="row mt-4">
                <div  class="col-12" style="display: flex;align-items: center;justify-content: end;column-gap: 10px;">
                    <button class="btn btn-primary" (click)="Confirm()">Confirm</button>
                    <button class="btn btn-danger"  (click)="Cancel()">Cancel Request</button>
                </div>
            </div>
        </div> 
    </div>
    
     
    <!-- Confirm popup -->
    <div class="container" style="margin: 2% auto !important;max-width: 91% !important;">
        <div class="background" [hidden]="hideConfirmpopUp">
          <div class="Ux_popup popup" style="position: relative;">
            <div>
              <!-- <ngx-spinner size="medium" [type]="typeSelected">
                <p style="font-size: 20px; color: white">Loading...</p>
              </ngx-spinner> -->
              <div>
                <div style="display: flex; align-items: center; justify-content: space-between;">
                  <div>
                    <b style="font-size: 17px !important;">Approve Cancel Request</b>
                  </div>
                  <div>
                    <i class="Ux_close fa-duotone fa-circle-xmark" (click)="closeConfirmPopUp()" ></i>
                  </div>
                </div>
              </div>
              <hr>
              <div class="MainDiv" style="padding: 10px;">
    
                <div class="row">
                    <div class="col-12">
                      <b style="font-size: 15px !important;">Customer Confirmation</b><br>
                      <textarea type="text" [(ngModel)]="CustomerConfirmationNotes" class="form-control" style="height: 60px;"></textarea>
                    </div>
                  </div>
    
    
              
                <div class="row mt-4">
                  <div class="col-12 d-flex justify-content-end">
                    <button class="btn btn-success" (click)="SubmitRequest('approve')">Submit</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    
      <!-- Cancel popup -->
      <div class="container" style="margin: 2% auto !important;max-width: 91% !important;">
        <div class="background" [hidden]="hideCancelpopup">
          <div class="Ux_popup popup" style="position: relative;">
            <div>
              <!-- <ngx-spinner size="medium" [type]="typeSelected">
                <p style="font-size: 20px; color: white">Loading...</p>
              </ngx-spinner> -->
              <div>
                <div style="display: flex; align-items: center; justify-content: space-between;">
                  <div>
                    <b style="font-size: 17px !important;">Cancel Reqest</b>
                  </div>
                  <div>
                    <i class="Ux_close fa-duotone fa-circle-xmark" (click)="CloseCancelpopUp()" ></i>
                  </div>
                </div>
              </div>
              <hr>
              <div class="MainDiv" style="padding: 10px;"> 
                <div class="row">
                    <div class="col-12">
                      <b style="font-size: 15px !important;">Customer Confirmation</b><br>
                      <textarea type="text" [(ngModel)]="CustomerConfirmationNotes" class="form-control" style="height: 60px;"></textarea>
                    </div>
                  </div> 
              
                <div class="row mt-4">
                  <div class="col-12 d-flex justify-content-end">
                    <button class="btn btn-success" (click)="SubmitRequest('cancel')">Submit</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    
    </div>
 
</ion-content>
